代码逻辑审计 (Check...Confirmation)
检查信号识别与统计的路径，逻辑是闭环且完备的，没有遗漏 B/C/D 级信号的死角。

代码路径分析 (CheckBullishSignalConfirmation)：

路径 A (P2 突破)：

条件：Close > P2

结果：EvaluateSignal 必定返回 S级 或 A级 (因为 is_CB=true)。

统计：g_Stats.Add 被调用。

路径 B (P1-DB 结构)：

条件：未触发路径 A，且 N_Geo >= 3。

结果：EvaluateSignal 根据空间因子计算。

若空间大：返回 B级 (DB结构)。

若空间小：返回 D级。

(注：C级通常出现在 IB 结构且未破 P2 的情况，但目前代码只处理了 DB 结构的次级逻辑，IB 的次级逻辑未显式处理，这解释了为什么 C 级很少见)

统计：g_Stats.Add 被调用。

结论：只要信号在图表上出现，g_Stats.Add 就会被执行。问题仅在于报告打印得太早了
===========================================================================================================================================
关于 C 级和 无效信号：

C级 (0)：代码逻辑中，次级扫描主要针对 N_Geo >= DB_Threshold_Candles (即 DB)。

C 级定义为 IB + 未破P2 + 空间大。目前的 Check 函数在 IB (N<3) 且未破 P2 时会直接 return，不进入评分逻辑，因此 C 级信号被设计为“忽略不计”是符合当前代码逻辑的。

无效 (0)：对应 GRADE_F (结构破坏 P2 < P1 for Bullish)。由于 FindP2Index 函数内部已经做了严格过滤 (candidate_P2 > P1_price)，

所以在 EvaluateSignal 中几乎不会再遇到结构破坏的情况。这是代码健壮性好的表现。

===========================================================================================================================================
结论就是 在 EvaluateSignal  会返回信号
S A B D  四种类型 不会有C级别信号，不会有GRADE_F，不会有NONE
