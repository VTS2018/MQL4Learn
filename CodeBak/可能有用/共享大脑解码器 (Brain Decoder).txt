// ==========================================================================
   // ç¬¬äºŒé˜¶æ®µï¼šæ ¸å¿ƒæ‰§è¡Œå¾ªç¯ (åªé’ˆå¯¹ç²¾è‹±ä¿¡å·è¿›è¡Œå†³ç­–)
   // ==========================================================================

   // ğŸš¨ æ–°ç‰ˆæ ¸å¿ƒæ‰«æé€»è¾‘ï¼šå¾ªç¯â€œæœ‰æ•ˆä¿¡å·åˆ—è¡¨ Xâ€ ğŸš¨
   for (int i = 0; i < total_valid_signals; i++)
   {
      // A. ä»åˆ—è¡¨ä¸­æå–å…³é”®ä¿¡æ¯
      FilteredSignal signal_item = sorted_valid_signals[i];
      int current_shift = signal_item.shift;
      
      Print("===> å¾ªç¯æ£€æŸ¥ä¿¡å· K[", current_shift, "] ç±»å‹: ", (signal_item.type == OP_BUY ? "BUY" : "SELL"));

      // B. è·å–åŸºç¡€æ•°æ®
      KBarSignal full_data = GetIndicatorBarData(current_shift);

      // =======================================================================
      // ğŸ§  [æ–°å¢] å…±äº«å¤§è„‘è§£ç å™¨ (Brain Decoder)
      // =======================================================================
      // ä¸ºäº†è·å–å«è¯„çº§çš„å°æ•°(å¦‚ 3.4)ï¼Œæˆ‘ä»¬å¿…é¡»ç›´æ¥è¯»å– Bufferï¼Œé˜²æ­¢è¢«åº•å±‚æˆªæ–­
      double raw_signal_value = 0.0;
      int    signal_type_int  = 0;
      int    signal_grade_int = 0;

      // 1. æ ¹æ®ä¿¡å·æ–¹å‘è¯»å–å¯¹åº”çš„æŒ‡æ ‡ç¼“å†²åŒº (2=Buy, 3=Sell)
      if (signal_item.type == OP_BUY)
      {
          raw_signal_value = iCustom(_Symbol, _Period, IndicatorName, Indi_Is_EA_Mode,
                                     Indi_Smart_Tuning, Indi_Scan_Range, 
                                     Indi_Lookahead_Bottom, Indi_Lookback_Bottom,
                                     Indi_Lookahead_Top, Indi_Lookback_Top,
                                     Indi_Max_Signal_Look, Indi_DB_Threshold, Indi_LLHH_Candles, 
                                     Indi_Timer_Interval_Seconds, Indi_DrawFibonacci,
                                     Indi_Show_History_Fibo, Indi_Hide_Invalid_Fibo, // æ³¨æ„ï¼šBot7å¦‚æœè¿˜æ²¡åŠ è¿™ä¸¤ä¸ªæ–°å‚æ•°ï¼Œå°±å…ˆå»æ‰
                                     2, current_shift); // Buffer 2
      }
      else if (signal_item.type == OP_SELL)
      {
          raw_signal_value = iCustom(_Symbol, _Period, IndicatorName, Indi_Is_EA_Mode,
                                     // ... åŒä¸Šçš„å‚æ•° ...
                                     Indi_Smart_Tuning, Indi_Scan_Range, 
                                     Indi_Lookahead_Bottom, Indi_Lookback_Bottom,
                                     Indi_Lookahead_Top, Indi_Lookback_Top,
                                     Indi_Max_Signal_Look, Indi_DB_Threshold, Indi_LLHH_Candles, 
                                     Indi_Timer_Interval_Seconds, Indi_DrawFibonacci,
                                     Indi_Show_History_Fibo, Indi_Hide_Invalid_Fibo,
                                     3, current_shift); // Buffer 3
      }

      // 2. è§£ç  (ä¾‹å¦‚ 3.4 -> Type=3, Grade=4)
      DecodeSignalQuality(raw_signal_value, signal_type_int, signal_grade_int);
      ENUM_SIGNAL_GRADE current_grade = (ENUM_SIGNAL_GRADE)signal_grade_int;

      // 3. è¯„çº§è¿‡æ»¤ (Quality Gate)
      if (current_grade < Min_Trade_Grade)
      {
          string grade_str = EnumToString(current_grade);
          string limit_str = EnumToString(Min_Trade_Grade);
          Print("ğŸ›‘ [Bot7è¿‡æ»¤] ä¿¡å· K[", current_shift, "] è¢«æ‹’ç»ã€‚è¯„çº§ä¸è¶³: ", grade_str, " < é—¨æ§›: ", limit_str);
          continue; // ğŸš¨ è·³è¿‡å½“å‰ä¿¡å·ï¼Œç›´æ¥è¿›å…¥ä¸‹ä¸€è½®å¾ªç¯
      }
      
      Print("âœ… [Bot7é€šè¿‡] å‘ç°ä¼˜è´¨ä¿¡å·! è¯„çº§: ", EnumToString(current_grade), " (Raw: ", DoubleToString(raw_signal_value, 1), ")");
      // =======================================================================

      // ----------------------------------------------------
      // ğŸš¨ åŸæœ‰é€»è¾‘ï¼šä¸Šä¸‹æ–‡æ£€æŸ¥ (Context Check)
      // ----------------------------------------------------
      int context_result = CheckSignalContext(current_shift, signal_item.type, clean_bulls, clean_bears);
      
      // ... (åç»­åŸæœ‰ä»£ç ä¿æŒä¸å˜) ...