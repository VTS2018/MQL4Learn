int CheckSignalAndFilter(const KBarSignal &data, int signal_shift)
{

   return -1;
   // --- è¿‡æ»¤ A: æ—¶é—´çª—å£å’Œæ—¥å†…é£æ§ (L3) ---
   // æ£€æŸ¥ï¼šäº¤æ˜“æ—¶é—´ã€æ—¥æœ€å¤§äºæŸã€æ—¥æœ€å¤§äº¤æ˜“æ¬¡æ•°ã€æ—¥ç›ˆåˆ©ç›®æ ‡
   // if (!IsTimeWindowAllowed())
   //    return OP_NONE;
   // if (!IsDailyRiskAllowed())
   //    return OP_NONE;
   // if (!IsTradingAllowedByStreak()) return OP_NONE; // è¿ç»­æ­¢æŸæ§åˆ¶

   int trade_command = OP_NONE;

   // --- è¿‡æ»¤ B: ä¿¡å·è´¨é‡å’Œå¤–éƒ¨ç¯å¢ƒ (L2) ---

   // --- 1. æ£€æŸ¥çœ‹æ¶¨ä¿¡å· ---
   // ä½¿ç”¨ ReferencePrice (ç°åœ¨æ˜¯è´¨é‡ä»£ç ) è¿›è¡Œåˆ¤æ–­
   if (data.BullishReferencePrice != (double)EMPTY_VALUE && data.BullishReferencePrice != 0.0)
   {
      string log_message = ">>> ä¾¦æµ‹åˆ°ä¿¡å· @ Kçº¿ç´¢å¼• shift=" + IntegerToString(signal_shift) + " (æ—¶é—´: " + TimeToString(data.OpenTime) + ") <<<";
      // A. å†…éƒ¨è¿‡æ»¤ï¼šæ£€æŸ¥ä¿¡å·è´¨é‡æ˜¯å¦æ»¡è¶³æœ€ä½è¦æ±‚
      if ((int)data.BullishReferencePrice >= Min_Signal_Quality)
      {
         // B. å¤–éƒ¨è¿‡æ»¤ï¼šæ£€æŸ¥çŸ©å½¢åŒºåŸŸã€MAç­‰å¤–éƒ¨æ¡ä»¶ (æš‚æœªå®ç°ï¼Œé»˜è®¤é€šè¿‡)
         // if (IsExternalConditionMet(OP_BUY))
         // {
         trade_command = OP_BUY;
         log_message += " | çœ‹æ¶¨ SL (Buffer 0): " + DoubleToString(data.BullishStopLossPrice, _Digits);
         log_message += " | è´¨é‡ (Buffer 2): " + DoubleToString(data.BullishReferencePrice, 1);
         Print(log_message, " | ", trade_command);
         // goto L3_FILTER_START;
         // }
      }
   }

    // --- 2. æ£€æŸ¥çœ‹è·Œä¿¡å· ---
   if (data.BearishReferencePrice != (double)EMPTY_VALUE && data.BearishReferencePrice != 0.0)
   {
      string log_message = ">>> ä¾¦æµ‹åˆ°ä¿¡å· @ Kçº¿ç´¢å¼• shift=" + IntegerToString(signal_shift) + " (æ—¶é—´: " + TimeToString(data.OpenTime) + ") <<<";
      // A. å†…éƒ¨è¿‡æ»¤ï¼šæ£€æŸ¥ä¿¡å·è´¨é‡æ˜¯å¦æ»¡è¶³æœ€ä½è¦æ±‚
      if ((int)data.BearishReferencePrice >= Min_Signal_Quality)
      {
         // B. å¤–éƒ¨è¿‡æ»¤ï¼šæ£€æŸ¥çŸ©å½¢åŒºåŸŸã€MAç­‰å¤–éƒ¨æ¡ä»¶ (æš‚æœªå®ç°ï¼Œé»˜è®¤é€šè¿‡)
         // if (IsExternalConditionMet(OP_SELL))
         // {
         trade_command = OP_SELL;
         log_message += " | çœ‹è·Œ SL (Buffer 1): " + DoubleToString(data.BearishStopLossPrice, _Digits);
         log_message += " | è´¨é‡ (Buffer 3): " + DoubleToString(data.BearishReferencePrice, 1);
         Print(log_message, " | ", trade_command);
         // goto L3_FILTER_START;
         // }
      }
   }

   // å¦‚æœä»¥ä¸Šéƒ½æ²¡æœ‰æ‰¾åˆ°ä¿¡å·ï¼Œtrade_command ä»ä¸º OP_NONEã€‚
   // return OP_NONE;

   // L3_FILTER_START:
    // --- è¿‡æ»¤ C (L3: ä¿¡å·ä½¿ç”¨è¿½è¸ª - é˜²é‡å¤äº¤æ˜“) ---
   if (trade_command != OP_NONE)
   {
      // ç”Ÿæˆå”¯ä¸€ ID: ä½¿ç”¨ä¿¡å· K çº¿çš„å¼€ç›˜æ—¶é—´ä½œä¸º ID
      // string signal_id = TimeToString(data.OpenTime, TIME_DATE | TIME_MINUTES);
      string signal_id = GenerateSignalID(data.OpenTime);
      // Print("---->[KTarget_FinderBot.mq4:605]: signal_id: ", signal_id);

      // ğŸš¨ æ£€æŸ¥è¯¥ä¿¡å·æ˜¯å¦å·²äº¤æ˜“ ğŸš¨
      if (IsSignalAlreadyTraded(signal_id))
      {
         Print("signal_id:", signal_id, "ä¿¡å·å·²è¢«äº¤æ˜“ï¼Œé˜»æ­¢å¼€ä»“");
         return OP_NONE; // ä¿¡å·å·²è¢«äº¤æ˜“ï¼Œé˜»æ­¢å¼€ä»“
      }
   }

    return trade_command;
}